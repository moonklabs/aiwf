# 스프린트를 위한 Task 생성 - 탑 다운 실행

통합 구현 가이드와 함께 기존 스프린트를 위한 상세 Task를 생성합니다.

## 정확히 다음 8개 항목으로 TODO 생성

1. 대상 스프린트 식별 및 존재 확인
2. 스프린트 컨텍스트 및 관련 문서 로드
3. 기존 ADR 및 기술 가이드 확인
4. Task 분해를 위한 스프린트 산출물 분석
5. 구현 가이드가 포함된 개별 Task 파일 생성
6. 관련 Task에 ADR 연결
7. Task 참조로 스프린트 메타 업데이트
8. 작업 품질 점검

각 단계에 대한 다음 지침을 단계별로 따르고 엄격히 준수하세요.

## 모든 TODO 항목의 세부사항

### 1. 대상 스프린트 식별 및 존재 확인

확인: <$ARGUMENTS>

**필수:** 스프린트 ID가 제공되어야 함 (예: S02). 비어있으면 사용자에게 어떤 스프린트를 상세화할지 지정하도록 요청.

- `.moonklabs/03_SPRINTS/`에 스프린트 디렉토리가 존재하는지 확인
- 스프린트 메타 파일이 존재하는지 확인 (예: `S02_sprint_meta.md`)
- 스프린트 상태가 이미 "완료"가 아닌지 확인
- Task가 이미 존재하면 사용자에게 재생성 여부나 다른 가이드를 원하는지 질문

### 2. 스프린트 컨텍스트 및 관련 문서 로드

병렬 서브에이전트를 사용하여 프로젝트 컨텍스트를 읽고 이해:

- 프로젝트 컨텍스트를 위해 `.moonklabs/00_PROJECT_MANIFEST.md` 읽기
- 목표와 산출물을 이해하기 위해 스프린트 메타 파일을 완전히 읽기
- `.moonklabs/02_REQUIREMENTS/`에서 상위 마일스톤 요구사항 읽기
- 기술 컨텍스트를 위해 `.moonklabs/01_PROJECT_DOCS/ARCHITECTURE.md` 읽기
- 아키텍처 결정을 이해하기 위해 `.moonklabs/01_PROJECT_DOCS/LONG_TERM_VISION.md` 읽기

**중요:** 스프린트 Task는 범위를 확장하지 않고 문서화된 스프린트 목표와 일치해야 함.

### 3. 기존 ADR 및 기술 가이드 확인

**병렬 서브에이전트를 사용**하여 다음 명령 실행:

- 스프린트 ID와 일치하는 ADR을 위해 `.moonklabs/05_ARCHITECTURE_DECISIONS/` 검색 (예: `ADR*_S02_*.md`)
- 기술 결정을 이해하기 위해 발견된 모든 ADR 읽기
- ADR 참조 섹션을 위해 스프린트 메타 확인
- Task 구현에 영향을 줄 기술 결정 메모
- Task와 하위 Task의 관계를 구축하고 구현할 내용을 명확히 하기

**범위 충돌** ADR과 스프린트 목표 사이에 충돌이 있으면, 생각해보고 사용자에게 충돌 해결을 요청.

**ADR이 발견되지 않으면:** 진행하되 구현 중에 Task가 명확히 될 필요가 있을 수 있음을 메모.

### 4. Task 분해를 위한 스프린트 산출물 분석

스프린트 목표와 산출물을 기반으로 (병렬 서브에이전트에서 실행):

- 상위 수준 산출물을 구체적이고 구현 가능한 Task로 분해
- 각 Task가 일관된 기능이나 컴포넌트를 나타내는지 확인
- Task 간의 논리적 종속성 고려
- 기술 가이드를 위해 Task를 관련 ADR에 매핑
- 하위 Task가 포함된 Task가 완전히 생성될 때까지 복잡성 평가 연기

### 5. 구현 가이드가 포함된 개별 Task 파일 생성

**이제** 식별된 각 Task에 대해 다음 지침으로 병렬 서브에이전트 실행:

    #### 각 Task에 대한 TODO 생성

    1. 기본 Task 구조 생성
    2. 코드베이스 인터페이스 조사
    3. 기술 가이드 추가
    4. Task 완전성 검증

    ### 1. 기본 Task 구조 생성

    - 모든 Task 파일은 스프린트 디렉토리에 생성되어야 함 (스프린트 메타 파일이 있는 곳)
    - 명명 규칙으로 파일 생성: `T<NN>_S<NN>_<설명적_이름>.md`
    - T01부터 시작하는 순차 번호 사용
    - `.moonklabs/99_TEMPLATES/task_template.md`의 Task 템플릿 구조를 정확히 따르기
    - 스프린트 목표에서 기본 설명과 목표 추가

    ### 2. 코드베이스 인터페이스 조사

    - 유사한 패턴과 인터페이스를 위해 기존 코드베이스 검토
    - 필요한 특정 클래스, 함수, 임포트 식별
    - 기존 모듈과의 통합 지점 찾기
    - 인터페이스할 데이터베이스 모델, API 엔드포인트 또는 서비스 메모
    - 기존 오류 처리 및 로깅 패턴 확인

    ### 3. 기술 가이드 추가

    Task 파일에 다음 섹션 추가 (템플릿에 없으면 추가):

    **기술 가이드 섹션:**

    - 코드베이스의 주요 인터페이스 및 통합 지점
    - 특정 임포트 및 모듈 참조
    - 따라야 할 기존 패턴
    - 작업할 데이터베이스 모델 또는 API 계약
    - 유사한 코드에서 사용된 오류 처리 접근법

    **구현 노트 섹션:**

    - 단계별 구현 접근법
    - 존중해야 할 주요 아키텍처 결정
    - 기존 테스트 패턴을 기반으로 한 테스트 접근법
    - 관련된 경우 성능 고려사항

    **중요:** 코드 예제를 포함하지 마세요. 구조적 가이드와 참조만 제공하세요.

    #### 4. Task 완전성 검증

    - Task가 명확한 구현 경로를 가지고 있는지 확인
    - 모든 통합 지점이 문서화되었는지 확인
    - 가이드가 실제 코드베이스 요소를 참조하는지 확인
    - Task가 독립적이고 실행 가능한지 확인

    **반복** 모든 Task에 대해 `### 5. 구현 가이드가 포함된 개별 Task 파일 생성`

### 6. 관련 Task에 ADR 연결

- 관련 ADR이 존재하는 경우
- 관련된 ADR 참조
- 각 ADR이 적용되는 방법에 대해 기술 가이드 섹션에 설명 추가
- Task가 구현에 영향을 주는 ADR만 참조하도록 확인

### 7. Task 참조로 스프린트 메타 업데이트

- Task 목록을 추가/업데이트하기 위해 스프린트 메타 파일 편집
- 논리적 그룹화 또는 종속성 순서로 Task 구성
- 각 Task에 대한 간단한 설명 추가

### 8. 작업 품질 점검

복잡성을 위해 생성된 모든 Task를 검토하고 높은 복잡성 Task 분할:

**복잡성 평가 프로세스:**

- 설명, 목표, 수락 기준, 하위 Task를 포함한 각 Task 파일을 완전히 읽기
- 전체 범위와 도전에 대한 판단을 사용하여 복잡성 평가
- 파일 수나 예상 시간과 같은 단순한 메트릭에 기반하지 않기
- 개념적 난이도, 통합 과제, 미지의 것들 고려
- Task frontmatter에 복잡성을 낮음, 중간, 높음으로 표시

**높은 복잡성으로 표시된 Task가 있는 경우:**

- Task를 낮음 또는 중간 복잡성의 2-3개 작은 Task로 분할
- 적절한 순차 번호로 새 Task 파일 생성
- 원래 높은 복잡성 Task 파일 업데이트 또는 삭제
- 분할된 Task가 함께 원래 목표를 달성하는지 확인
- 논리적 그룹화와 종속성 유지

**모든 Task가 최종화된 후:**

- 모든 Task가 낮음 또는 중간 복잡성만인지 확인
- Task 번호가 순차적인지 확인 (T01, T02, T03...)
- 최종 Task 목록으로 스프린트 메타 파일 업데이트
- 실제 생성된 Task를 반영하도록 프로젝트 매니페스트 스프린트 섹션 업데이트
- 완료 보고서 생성

**출력 형식:**

    ```Markdown
    ## 스프린트 상세화 완료 - [YYYY-MM-DD HH:MM]

    **스프린트:** [스프린트 ID] - [스프린트 이름]
    **상태:** 계획 완료

    **생성된 Task:** [분할 후 최종 수]
    - 중간 복잡성: [수]
    - 낮은 복잡성: [수]

    **Task 분할 요약:**
    - [범위로 인해 원래 T03이 T03과 T04로 분할됨]
    - [다른 분할은 필요하지 않음]

    **최종 Task 목록:**
    1. T01_S02 - [제목] (복잡성: [레벨])
    2. T02_S02 - [제목] (복잡성: [레벨])
    [모든 Task에 대해 계속]

    **다음 단계:**
    - 완전성을 위해 Task 검토
    - 구현을 시작하려면 `/do_task [스프린트의_첫_번째_Task]` 실행
    ```