# 경량 평가 시스템

## 개요

AIWF의 경량 평가 시스템은 AI 응답 품질을 간단하고 효율적으로 모니터링합니다. 복잡한 수동 평가 대신 백그라운드 자동 평가를 통해 사용자 작업 흐름을 방해하지 않으면서도 품질을 유지합니다.

## 핵심 원칙

### 1. Invisible by Default
- 평가는 백그라운드에서 자동 실행
- 사용자가 인지하지 못하도록 설계
- 필요할 때만 피드백 제공

### 2. Simple Metrics
- 3가지 핵심 지표만 사용
- 복잡한 계산 없이 빠른 평가
- 실용적인 피드백 중심

### 3. Non-Intrusive
- 품질이 낮을 때만 알림 (60% 미만)
- 간단한 한 줄 피드백
- 작업 흐름을 방해하지 않음

## 평가 지표

### 1. 역할 일치도 (Role Alignment) - 50%
페르소나의 핵심 키워드가 응답에 포함되었는지 확인합니다.

```javascript
// 페르소나별 핵심 키워드
architect: ['시스템', '설계', '구조', '아키텍처']
security: ['보안', '취약점', '암호화', '위협']
frontend: ['UI', 'UX', '사용자', '화면']
backend: ['API', '데이터베이스', '서버', '성능']
data_analyst: ['데이터', '분석', '통계', '인사이트']
```

### 2. 작업 관련성 (Task Relevance) - 30%
응답의 길이와 내용으로 작업 관련성을 간단히 평가합니다.
- 50자 미만: 0.3
- 50-200자: 0.6
- 200자 이상: 0.8

### 3. 기본 품질 (Response Quality) - 20%
응답의 구조와 내용 풍부도를 확인합니다.
- 구조화된 응답 (줄바꿈, 목록 등): +0.2
- 충분한 내용 (100자 이상): +0.2

## 자동 평가 시점

### 1. 페르소나 전환 시
```bash
$ aiwf persona architect
✓ Architect 페르소나 활성화
# (백그라운드에서 자동 평가 시작)
```

### 2. 컨텍스트 압축 시
```bash
$ aiwf compress-with-persona
✓ 압축 완료!
# (압축 품질 자동 체크)
💡 시스템 설계 관점을 더 포함해보세요  # 품질이 낮을 때만
```

## 수동 평가 명령어

필요할 때 수동으로 평가 정보를 확인할 수 있습니다.

### 빠른 확인
```bash
$ aiwf evaluate
🔍 최근 응답 평가
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
현재 페르소나: architect
평균 점수: 0.75
평가 횟수: 23
추세: 📈 개선 중
```

### 상세 분석
```bash
$ aiwf evaluate --detailed
📊 상세 평가 분석
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
전체 통계:
- 총 평가: 47회
- 평균 점수: 0.72
- 추세: 📈 개선 중

페르소나별 성과:
- 아키텍트: 0.85 (15회)
- 보안 전문가: 0.62 (8회)
- 프론트엔드: 0.74 (12회)
- 백엔드: 0.70 (9회)
- 데이터 분석가: 0.58 (3회)

개선 제안:
📊 데이터 기반 인사이트를 더 제공해보세요
```

### 평가 히스토리
```bash
$ aiwf evaluate --history
📈 평가 히스토리
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
14:32 | 아키텍트 | 0.85
14:25 | 프론트엔드 | 0.72
14:18 | 아키텍트 | 0.90
...
```

### 주간 통계
```bash
$ aiwf evaluate --stats
📊 주간 통계
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
평가 횟수: 142회
평균 점수: 0.74
추세: 📈 개선 중

페르소나별 활용도:
아키텍트    ████████████ 45회
프론트엔드  ████████ 32회
백엔드      ██████ 28회
보안 전문가  ████ 20회
데이터 분석가 ████ 17회
```

## 피드백 메시지

각 페르소나별로 간단한 피드백 메시지가 준비되어 있습니다:

- **Architect**: "💡 시스템 설계 관점을 더 포함해보세요"
- **Security**: "🔒 보안 측면을 좀 더 고려해보세요"
- **Frontend**: "🎨 사용자 경험 관점을 추가해보세요"
- **Backend**: "⚙️ 서버/데이터 처리 관점을 강화해보세요"
- **Data Analyst**: "📊 데이터 기반 인사이트를 더 제공해보세요"

## 데이터 저장

평가 데이터는 `.aiwf/.evaluation-stats.json`에 자동 저장됩니다:

```json
{
  "recentEvaluations": [
    {
      "persona": "architect",
      "score": 0.85,
      "timestamp": "2024-01-10T14:32:00Z",
      "responseLength": 350
    }
  ],
  "lastUpdated": "2024-01-10T14:32:00Z"
}
```

## 구현 세부사항

### SimplifiedEvaluator 클래스
- 200줄 이하의 간단한 구현
- 빠른 평가 알고리즘
- 최소한의 의존성

### BackgroundMonitor 클래스
- 싱글톤 패턴으로 리소스 효율성
- 비동기 평가로 성능 영향 최소화
- 자동 데이터 정리 (최대 100개 기록)

## 마이그레이션 가이드

### 기존 시스템에서 전환
1. 기존 평가 명령어들이 자동으로 제거됨
2. 새로운 `aiwf evaluate` 명령어만 사용
3. 대부분의 평가는 자동으로 백그라운드에서 수행

### 주요 변경사항
- 5개 지표 → 3개 지표
- 수동 평가 → 자동 평가
- 5개 명령어 → 1개 명령어
- 복잡한 리포트 → 간단한 피드백

## 성능 영향

- **CPU 사용**: 거의 없음 (< 0.1%)
- **메모리 사용**: 최소 (< 5MB)
- **평가 시간**: 즉시 (< 10ms)
- **저장 공간**: 작음 (< 100KB)

## 향후 계획

1. **AI 응답 후 자동 평가**: Claude API 응답 후킹
2. **주간 리포트 자동 생성**: 매주 월요일 아침
3. **팀 통계 공유**: 팀원 간 평가 통계 공유 기능

## 결론

경량 평가 시스템은 "적을수록 좋다"는 철학을 따릅니다. 필수적인 기능만 유지하면서도 AI 응답 품질을 효과적으로 모니터링할 수 있습니다. 사용자는 평가 시스템의 존재를 거의 인지하지 못하면서도 품질 개선의 혜택을 받습니다.