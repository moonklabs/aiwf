# 코드 리뷰 - 탑 다운 실행

코드 리뷰를 실행하기 위해 다음 지침을 탑 다운 방식으로 따르세요.

## '정확히' 다음 6개 항목으로 TODO 생성

1. 주어진 범위 분석
2. 범위 내에서 코드 변경사항 찾기
3. 관련 명세서 및 문서 찾기
4. 문서 및 요구사항과 코드 변경사항 비교
5. 가능한 차이점 분석
6. 세부사항과 함께 PASS/FAIL 판정 제공

각 단계에 대한 다음 지침을 단계별로 따르고 엄격히 준수하세요.

## 모든 TODO 항목의 '세부사항'

### 1. 주어진 범위 분석

확인: <$ARGUMENTS>

비어있으면 기본값을 사용하고, 그렇지 않으면 <$ARGUMENTS>를 해석하여 리뷰 범위를 식별합니다. 의미있는 변경사항을 찾을 수 있는 경우에만 계속하세요.

**CONTEXT:** 코드 변경사항을 리뷰하기 전에:

- 현재 스프린트와 마일스톤 컨텍스트를 이해하기 위해 `.moonklabs/00_PROJECT_MANIFEST.md` 읽기
- 매니페스트를 사용하여 활성 스프린트와 범위 내 작업 식별
- 현재 스프린트의 산출물에 적합한 요구사항만 평가

### 2. 범위 내에서 코드 변경사항 찾기

식별된 범위로 `git diff` (기본값: `git diff HEAD~1`)를 사용하여 코드 변경사항을 찾습니다.

### 3. 관련 명세서 및 문서 찾기

- FIND: 수행된 작업과 관련된 태스크, 스프린트, 마일스톤을 찾고 결과를 출력
- NAVIGATE: 현재 스프린트 디렉토리를 찾기 위해 `.moonklabs/03_SPRINTS/`로 이동
- READ: 스프린트 목표와 산출물을 이해하기 위해 스프린트 메타 파일 읽기
- READ: 특정 태스크가 범위에 있다면, 스프린트 디렉토리에서 태스크 파일 찾고 읽기
- IDENTIFY: 현재 마일스톤에 대한 `.moonklabs/02_REQUIREMENTS/`의 관련 요구사항 식별
- READ: 특히 `.moonklabs/01_PROJECT_DOCS/`와 `.moonklabs/02_REQUIREMENTS/`의 관련 문서 읽기
- **IMPORTANT:** 미래 마일스톤 기능이 아닌 현재 스프린트 산출물에 집중

### 4. 문서 및 요구사항과 코드 변경사항 비교

- 딥 씽킹을 사용하여 발견된 요구사항 및 명세와 변경사항 비교
- 특히 다음 사항들을 비교:
  - **Data Model / Schema** — 필드, 타입, 제약조건, 관계
  - **API / Interface** — 엔드포인트, 매개변수, 반환 형태, 상태 코드, 오류
  - **Configuration / Environment** — 키, 기본값, 필수/선택
  - **Behavior** — 비즈니스 규칙, 부작용, 오류 처리
  - **Quality** — 명명, 포맷팅, 테스트, 린터 상태

**IMPORTANT**:

- 명세서와의 편차는 허용되지 않습니다. 작은 것도 안됩니다. 여기서 매우 까다롭게 하세요!
- 의심스러우면 **FAIL**을 선언하고 사용자에게 물어보세요.
- 명세서와 문서를 따르지 않는 것에 대한 무관용 원칙.

### 5. 차이점 분석

- 발견된 모든 차이점 분석
- 모든 이슈에 심각도 점수 부여
- 심각도는 1(낮음)에서 10(높음)까지
- 출력을 위해 이슈 목록과 점수 기억

### 6. 세부사항과 함께 PASS/FAIL 판정 제공

- 발견된 차이점에 대해 **FAIL** 선언
  - 무관용 원칙 - 선의의 추가사항도 포함
  - 작은 변경사항이 허용되는지는 사용자가 결정하도록 남겨둠
- 불일치가 없는 경우에만 **PASS**

#### IMPORTANT: 출력 형식

- 태스크 파일의 **## Output Log** 섹션에 리뷰 결과 출력
- 범위에 따라 `.moonklabs/03_SPRINTS/` 또는 `.moonklabs/04_GENERAL_TASKS/`에서 태스크 파일 찾기
- 타임스탬프와 함께 기존 Output Log에 리뷰 결과 추가
- 출력 형식:
  ```
  [YYYY-MM-DD HH:MM]: 코드 리뷰 - PASS/FAIL
  결과: **FAIL/PASS** 합격 또는 불합격에 대한 최종 결정.
  **범위:** 리뷰 범위에 대해 사용자에게 알림.
  **발견사항:** 발견된 모든 이슈와 심각도 점수가 포함된 상세 목록.
  **요약:** 무엇이 잘못되었거나 문제없는지에 대한 간단한 요약.
  **권장사항:** 다음 단계에 대한 개인적인 권장사항.
  ```
- 즉각적인 피드백을 위해 콘솔에 간단한 결과 요약도 출력